{{/* Steam成就展示短代码 */}}
{{/* 使用方法: {{< steam_achievements >}} */}}

{{ $achievements := .Site.Data.steam_achievements }}
{{ if $achievements }}
<div class="steam-achievements-container">
    <div class="achievements-header">
        <h3>Steam成就列表</h3>
        <p class="achievements-info">
            游戏: {{ $achievements.gameInfo.name }} | 
            总成就数: {{ $achievements.gameInfo.totalAchievements }} | 
            最后更新: {{ $achievements.lastUpdated | time.Format "2006-01-02 15:04" }}
        </p>
    </div>
    
    <div class="achievements-grid">
        {{ range $achievements.achievements }}
        <div class="achievement-card {{ if eq .hidden 1 }}hidden-achievement{{ end }}" data-name-zh="{{ with .displayName_zh }}{{ . }}{{ else }}{{ .displayName }}{{ end }}" data-name-en="{{ with .displayName_en }}{{ . }}{{ else }}{{ .displayName }}{{ end }}" data-desc-zh="{{ with .description_zh }}{{ . }}{{ else }}{{ .description }}{{ end }}" data-desc-en="{{ with .description_en }}{{ . }}{{ else }}{{ .description }}{{ end }}">
            <div class="achievement-icon">
                <a href="{{ .steamUrl }}" target="_blank" rel="noopener">
                    <img src="{{ .icon }}" alt="{{ .displayName }}" 
                         onerror="this.src='{{ .icongray }}'">
                </a>
            </div>
            
            <div class="achievement-info">
                <h4 class="achievement-name">
                    <a href="{{ .steamUrl }}" target="_blank" rel="noopener">
                            <span class="achievement-name-text">{{ with .displayName_zh }}{{ . }}{{ else }}{{ .displayName }}{{ end }}</span>
                    </a>
                    {{ if eq .hidden 1 }}
                        <span class="hidden-badge">隐藏</span>
                    {{ end }}
                </h4>
                
                    <p class="achievement-description">{{ with .description_zh }}{{ . }}{{ else }}{{ .description }}{{ end }}</p>
                
                <div class="achievement-links">
                    <a href="{{ .steamUrl }}" target="_blank" rel="noopener" class="steam-link">
                        <i class="steam-icon"></i> 查看Steam页面
                    </a>
                </div>
            </div>
        </div>
        {{ end }}
    </div>
</div>

<style>
.steam-achievements-container {
    margin: 2rem 0;
    padding: 1.5rem;
    border: 1px solid var(--border-color, #e1e5e9);
    border-radius: 8px;
    background: var(--bg-secondary, #f8f9fa);
}

.achievements-header h3 {
    margin: 0 0 0.5rem 0;
    color: var(--text-primary, #171a21);
    font-size: 1.5rem;
}

.achievements-info {
    margin: 0 0 1.5rem 0;
    color: var(--text-secondary, #8f98a0);
    font-size: 0.9rem;
}

.achievements-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1rem;
}

.achievement-card {
    display: flex;
    background: var(--bg-primary, white);
    border: 1px solid var(--border-light, #d6d9dc);
    border-radius: 6px;
    padding: 1rem;
    transition: all 0.2s ease;
}

.achievement-card:hover {
    border-color: var(--accent-color, #1b2838);
    box-shadow: 0 2px 8px var(--shadow-color, rgba(0,0,0,0.1));
}

.achievement-card.hidden-achievement {
    background: var(--bg-tertiary, #f0f0f0);
    border-color: var(--border-secondary, #c0c0c0);
}

.achievement-icon {
    margin-right: 1rem;
    flex-shrink: 0;
}

.achievement-icon img {
    width: 64px;
    height: 64px;
    border-radius: 4px;
}

.achievement-info {
    flex: 1;
    min-width: 0;
}

.achievement-name {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    line-height: 1.3;
}

.achievement-name a {
    color: var(--text-primary, #1b2838);
    text-decoration: none;
}

.achievement-name a:hover {
    color: var(--link-hover, #66c0f4);
    text-decoration: underline;
}

.hidden-badge {
    display: inline-block;
    background: #ff6b6b;
    color: white;
    font-size: 0.7rem;
    padding: 0.2rem 0.5rem;
    border-radius: 3px;
    margin-left: 0.5rem;
}

.achievement-description {
    margin: 0 0 1rem 0;
    color: var(--text-secondary, #8f98a0);
    font-size: 0.9rem;
    line-height: 1.4;
}

.achievement-links {
    margin-top: auto;
}

.steam-link {
    display: inline-flex;
    align-items: center;
    color: var(--link-color, #66c0f4);
    text-decoration: none;
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
    border: 1px solid var(--link-color, #66c0f4);
    border-radius: 3px;
    transition: all 0.2s ease;
}

.steam-link:hover {
    background: var(--link-color, #66c0f4);
    color: white;
}

.steam-icon {
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-right: 0.3rem;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c5.52 0 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>') no-repeat center;
    background-size: contain;
}

/* 响应式设计 */
@media (max-width: 768px) {
    .achievements-grid {
        grid-template-columns: 1fr;
    }
    
    .achievement-card {
        flex-direction: column;
        text-align: center;
    }
    
    .achievement-icon {
        margin-right: 0;
        margin-bottom: 1rem;
    }
}

/* 深色主题支持 */
@media (prefers-color-scheme: dark) {
    .steam-achievements-container {
        --bg-secondary: #1a1a1a;
        --border-color: #333;
        --bg-primary: #2d2d2d;
        --border-light: #444;
        --border-secondary: #555;
        --text-primary: #ffffff;
        --text-secondary: #b0b0b0;
        --accent-color: #66c0f4;
        --link-color: #66c0f4;
        --link-hover: #4a9fd1;
        --shadow-color: rgba(255,255,255,0.1);
        --bg-tertiary: #1a1a1a;
    }
}

/* 浅色主题支持 */
@media (prefers-color-scheme: light) {
    .steam-achievements-container {
        --bg-secondary: #f8f9fa;
        --border-color: #e1e5e9;
        --bg-primary: white;
        --border-light: #d6d9dc;
        --border-secondary: #c0c0c0;
        --text-primary: #171a21;
        --text-secondary: #8f98a0;
        --accent-color: #1b2838;
        --link-color: #66c0f4;
        --link-hover: #4a9fd1;
        --shadow-color: rgba(0,0,0,0.1);
        --bg-tertiary: #f0f0f0;
    }
}

/* 如果主题使用CSS类切换，支持类名方式 */
.theme-dark .steam-achievements-container {
    --bg-secondary: #1a1a1a;
    --border-color: #333;
    --bg-primary: #2d2d2d;
    --border-light: #444;
    --border-secondary: #555;
    --text-primary: #ffffff;
    --text-secondary: #b0b0b0;
    --accent-color: #66c0f4;
    --link-color: #66c0f4;
    --link-hover: #4a9fd1;
    --shadow-color: rgba(255,255,255,0.1);
    --bg-tertiary: #1a1a1a;
}

.theme-light .steam-achievements-container {
    --bg-secondary: #f8f9fa;
    --border-color: #e1e5e9;
    --bg-primary: white;
    --border-light: #d6d9dc;
    --border-secondary: #c0c0c0;
    --text-primary: #171a21;
    --text-secondary: #8f98a0;
    --accent-color: #1b2838;
    --link-color: #66c0f4;
    --link-hover: #4a9fd1;
    --shadow-color: rgba(0,0,0,0.1);
    --bg-tertiary: #f0f0f0;
}
</style>
{{ else }}
<div class="steam-achievements-error">
    <p>无法加载Steam成就数据。请检查数据文件是否存在。</p>
</div>
{{ end }}
